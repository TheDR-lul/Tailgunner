# üó∫Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ —Å–µ—Ç–∫–∏ –∫–∞—Ä—Ç

## üéØ –ü—Ä–æ–±–ª–µ–º–∞

War Thunder API (`localhost:8111`) –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã —Å–µ—Ç–∫–∏**:

| –ö–∞—Ä—Ç–∞ | API –≥–æ–≤–æ—Ä–∏—Ç | –†–µ–∞–ª—å–Ω–æ | –û—à–∏–±–∫–∞ |
|-------|-------------|---------|--------|
| **Attica** | 200m √ó 200m | **225m √ó 225m** | ‚ùå **25m** |
| American Desert | 200m √ó 200m | **175m √ó 175m** | ‚ùå **25m** |
| Abandoned Factory | 200m √ó 200m | **150m √ó 150m** | ‚ùå **50m** |

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º —Å–µ—Ç–∫–∏ (A-Z, 1-20).

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### **1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç** (`src-tauri/src/map_database.rs`)

–°–æ–∑–¥–∞–Ω–∞ –±–∞–∑–∞ —Å **—Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏** –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç—ã:

```rust
pub struct MapGridInfo {
    pub name: String,
    pub ground_grid_step: Option<f32>,  // –†–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä!
    pub air_grid_step: Option<f32>,
    pub naval_grid_step: Option<f32>,
    pub map_size: [f32; 2],
}
```

**–ü—Ä–∏–º–µ—Ä—ã:**
- ‚úÖ Attica: `225m √ó 225m` (–Ω–µ 200m!)
- ‚úÖ American Desert: `175m √ó 175m`
- ‚úÖ Abandoned Factory: `150m √ó 150m`
- ‚úÖ European Province: `200m √ó 200m` (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)

### **2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å map_module** (`src-tauri/src/map_module.rs`)

```rust
// –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ‚Üí API
let (grid_step_x, grid_step_y) = if let Some(correct) = self.correct_grid_step {
    (correct[0], correct[1])  // ‚úì –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ!
} else {
    (self.info.grid_steps[0], self.info.grid_steps[1])  // Fallback
};
```

### **3. UI –ò–Ω—Ñ–æ–±–æ–∫—Å** (`src/components/MapInfoBox.tsx`)

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã —Å–µ—Ç–∫–∏ –∏–∑ –∏–≥—Ä—ã
- ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ API –Ω–µ—Ç–æ—á–µ–Ω
- üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ä—Ç–µ (—Ä–∞–∑–º–µ—Ä, —Ä–µ–∂–∏–º—ã)

**–ü—Ä–∏–º–µ—Ä:**
```
[i] –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞—Ä—Ç–µ

–ö–∞—Ä—Ç–∞: Attica
–†–∞–∑–º–µ—Ä: 4.1km √ó 4.1km

–†–∞–∑–º–µ—Ä—ã —Å–µ—Ç–∫–∏ (–∏–∑ –∏–≥—Ä—ã):
üöú –¢–∞–Ω–∫–∏: 225m √ó 225m

‚ö†Ô∏è API –Ω–µ—Ç–æ—á–µ–Ω!
API –¥–∞—ë—Ç: 200m √ó 200m ‚úó
–†–µ–∞–ª—å–Ω–æ: 225m √ó 225m ‚úì

–ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```

---

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### **–ü–∞—Ä—Å–µ—Ä –∫–∞—Ä—Ç** (`tools/parse_wt_maps.py`)

–ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏–∑ —Ñ–∞–π–ª–æ–≤ –∏–≥—Ä—ã:

```bash
python tools/parse_wt_maps.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- `wt_maps_database.json` - JSON —Å –¥–∞–Ω–Ω—ã–º–∏
- `map_database_generated.rs` - Rust –∫–æ–¥

**–°–º. –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** [`tools/README_MAP_PARSER.md`](tools/README_MAP_PARSER.md)

---

## üìä –¢–µ–∫—É—â–∞—è –±–∞–∑–∞ (12 –∫–∞—Ä—Ç)

### **–¢–∞–Ω–∫–æ–≤—ã–µ:**
1. ‚úÖ **Attica** - 225m (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!)
2. ‚úÖ European Province - 200m
3. ‚úÖ Mozdok - 200m
4. ‚úÖ Fulda Gap - 200m (–±–æ–ª—å—à–∞—è)
5. ‚úÖ **Abandoned Factory** - 150m (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!)
6. ‚úÖ Karelia - 200m
7. ‚úÖ Sinai - 200m (–±–æ–ª—å—à–∞—è)
8. ‚úÖ **American Desert** - 175m (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ!)
9. ‚úÖ Fields of Poland - 200m
10. ‚úÖ Maginot Line - 200m

### **–ê–≤–∏–∞—Ü–∏–æ–Ω–Ω—ã–µ:**
1. ‚úÖ Berlin - 13.1km

### **–ú–æ—Ä—Å–∫–∏–µ:**
1. ‚úÖ Bay of Naples - 800m

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### **–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É:**

1. –°–æ–±—Ä–∞—Ç—å –¥–∞–º–ø API:
```javascript
invoke('dump_wt_api')
```

2. –ù–∞–π—Ç–∏ `map_min`, `map_max`, `grid_steps`

3. –î–æ–±–∞–≤–∏—Ç—å –≤ `map_database.rs`:
```rust
self.maps.insert("new_map".to_string(), MapGridInfo {
    name: "new_map".to_string(),
    localized_name: "New Map".to_string(),
    ground_grid_step: Some(225.0),  // –†–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä!
    // ...
});
```

### **–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–µ—Ä:**

```bash
python tools/parse_wt_maps.py
# ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ—á—ë—Ç –í–°–ï –∫–∞—Ä—Ç—ã –∏–∑ –∏–≥—Ä—ã!
```

---

## üéÆ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### **–î–µ—Ç–µ–∫—Ü–∏—è –∫–∞—Ä—Ç—ã:**
1. API –¥–∞—ë—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: `map_min`, `map_max`, `grid_zero`
2. –ò—â–µ–º –≤ –±–∞–∑–µ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
3. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã
4. –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí fallback –Ω–∞ API (—Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º)

### **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ—Ç–∫–∏:**
```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∏–∑ –±–∞–∑—ã!
const gridStepX = mapData.correct_grid_step?.[0] ?? info.grid_steps[0];
const gridStepY = mapData.correct_grid_step?.[1] ?? info.grid_steps[1];
```

### **–†–∞—Å—á–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:**
```rust
// Attica: 225m –≤–º–µ—Å—Ç–æ 200m –∏–∑ API!
let grid_x = (abs_x / grid_step_x).floor() as i32;
let grid_y = (abs_y / grid_step_y).floor() as i32;
// ‚Üí –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –Ω–∞ —Å–µ—Ç–∫–µ A-Z, 1-20
```

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–¢–æ—á–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Å–µ—Ç–∫–∏**
‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –∏–≥—Ä–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π**
‚úÖ **–ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —Ñ–∏–¥–∞** –ø—Ä–∏ —Å–º–µ–Ω–µ –±–æ—è
‚úÖ **–ò–Ω—Ñ–æ–±–æ–∫—Å —Å —Ä–µ–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π**
‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç** (—Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è)
‚úÖ **–ü–∞—Ä—Å–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏**

---

## üîÑ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### **Rust Backend:**
- ‚úÖ `src-tauri/src/map_database.rs` (–Ω–æ–≤—ã–π)
- ‚úÖ `src-tauri/src/map_module.rs` (–æ–±–Ω–æ–≤–ª—ë–Ω)
- ‚úÖ `src-tauri/src/map_detection.rs` (–æ–±–Ω–æ–≤–ª—ë–Ω)
- ‚úÖ `src-tauri/src/lib.rs` (–Ω–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞)

### **React Frontend:**
- ‚úÖ `src/components/MapInfoBox.tsx` (–Ω–æ–≤—ã–π)
- ‚úÖ `src/components/MapInfoBox.css` (–Ω–æ–≤—ã–π)
- ‚úÖ `src/components/MiniMap.tsx` (–æ–±–Ω–æ–≤–ª—ë–Ω)
- ‚úÖ `src/components/GameChat.tsx` (–æ—á–∏—Å—Ç–∫–∞ —Ñ–∏–¥–∞)

### **Tools:**
- ‚úÖ `tools/parse_wt_maps.py` (–Ω–æ–≤—ã–π)
- ‚úÖ `tools/README_MAP_PARSER.md` (–Ω–æ–≤—ã–π)

---

## üéØ TODO

- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ 150+ –∫–∞—Ä—Ç –∏–∑ –∏–≥—Ä—ã
- [ ] –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–∞—Ç—á–µ WT
- [ ] –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–∏–Ω–∏–∫–∞—Ä—Ç (`.dds` —Ç–µ–∫—Å—Ç—É—Ä—ã)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–æ–≤

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

**–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞:** Attica, European Province, Mozdok, Fulda Gap

